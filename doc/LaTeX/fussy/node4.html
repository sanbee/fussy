<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Error propagation: Algorithm for the multi-variate case</TITLE>
<META NAME="description" CONTENT="Error propagation: Algorithm for the multi-variate case">
<META NAME="keywords" CONTENT="fussy">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="fussy.css">

<LINK REL="next" HREF="node10.html">
<LINK REL="previous" HREF="node2.html">
<LINK REL="up" HREF="fussy.html">
<LINK REL="next" HREF="node5.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html82"
  HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html80"
  HREF="fussy.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html74"
  HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html83"
  HREF="node5.html">The multiplication operator</A>
<B> Up:</B> <A NAME="tex2html81"
  HREF="fussy.html">The fussy language: Implementation</A>
<B> Previous:</B> <A NAME="tex2html75"
  HREF="node3.html">Example</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00030000000000000000"></A>
<A NAME="SEC:MULTI_VAR"></A>
<BR>
Error propagation: Algorithm for the multi-variate case
</H1>

<P>
The algorithm for the multi-variate case is similar to the
single-variate case described above, but slightly more complicated.
Multi-variate expressions have the added complication that the terms
in the summation of Eq.&nbsp;<A HREF="node1.html#FERR">1</A> have to be evaluated separately for
<I>each independent</I> variable.  This means that a <TT>DS</TT> and a table
of measurement errors (<TT>ME</TT>) <I>per independent</I> variable have
to be maintained.

<P>
Symbols (variables and constants) in <TT>fussy</TT> are tagged with a number
or a list of numbers (the IDs) and a type.  Symbols representing
normal variables are of the type <TT>VAR</TT> and have a single unique
ID, a random error and a partial derivative (of value 1) associated
with them.  Symbols representing sub-expressions are of the type <TT>PARTIAL_VAR</TT> and have a list of IDs and a corresponding list of
random errors and partial derivatives associated with them.  List of
unique IDs and the random errors of the independent variables in the
expression on the right-hand side (RHS) of the assignment operator
constitute the list of IDs and random errors for the <TT>PARTIAL_VAR</TT> type symbols.  When a symbol (of either type) is pushed
on the <TT>VMS</TT>, the entire list of associated IDs is copied to the ID
list of the object on the stack.  The corresponding random errors and
partial derivatives are also copied in the appropriate locations in
the <TT>ME</TT> table and pushed on the appropriate <TT>DS</TT> respectively.
For example, let the IDs of <IMG
 WIDTH="21" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img34.png"
 ALT="$x_1$">
 and <IMG
 WIDTH="21" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$x_2$">
 be <IMG
 WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$1$">
 and <IMG
 WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img36.png"
 ALT="$2$">

respectively.  The result of <IMG
 WIDTH="55" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img37.png"
 ALT="$x_1 * x_2$">
 on the top of the <TT>VMS</TT> will
have an ID list of <TT>{1,2}</TT> retaining the information that the
result is statistically dependent on the independent variates <IMG
 WIDTH="21" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img34.png"
 ALT="$x_1$">

and <IMG
 WIDTH="21" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$x_2$">
.  If this result is further used as part of another
expression, this information will be used to propagate the chain rule
for these variables correctly.

<P>
Since any expression is built using basic mathematical operators or
built-in functions, for the purpose of proving the correctness of the
error propagation algorithm for any arbitrary expression, it is
sufficient to prove that the algorithm works for the fundamental
mathematical operators and built-in functions.  The algorithms for
evaluating the partial derivatives involving mathematical operators
and the final evaluation of the resulting error is described below as
pseudo code (see Appendix&nbsp;<A HREF="node13.html#APPEN:EX">A</A> for an example).  The
algorithms are described using the following pseudo functions:

<UL>
<LI><TT>push(S)</TT>: to push the symbol or value <TT>S</TT> on the <TT>VMS</TT>. 
</LI>
<LI><TT>push(S,DS[i])</TT>: to push the symbol or value <TT>S</TT> on the
<IMG
 WIDTH="21" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$i^{th}$">
 <TT>DS</TT>.  
</LI>
<LI><TT>pop()</TT>: to pop a symbol from the <TT>VMS</TT>.
</LI>
<LI><TT>Top(DS[i])</TT>:  represents the value on the top of the
<IMG
 WIDTH="21" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$i^{th}$">
 <TT>DS</TT>. 
</LI>
</UL>
The <TT>DS</TT> is indexed by the symbol ID(s) (say, <TT>N</TT>).  When a symbol
from one of the symbol tables is pushed on the <TT>VMS</TT>, a value of <IMG
 WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$1$">
 is
pushed on <TT>DS[N]</TT> and the associated measurement error is copied
into <TT>ME[N]</TT>.  <TT>L</TT> and <TT>R</TT> in the pseudo code represents
the symbols on the left-hand-side (LHS) and right-hand side (RHS) of
the operator respectively.  Two functions <IMG
 WIDTH="55" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img39.png"
 ALT="$f(x,a)$">
 and <IMG
 WIDTH="54" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img40.png"
 ALT="$g(x,b)$">
 with
one common variable (<IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$x$">
) and one non-common variable each (<IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img41.png"
 ALT="$a$">
 and
<IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img42.png"
 ALT="$b$">
) are used as the LHS and RHS operands in the explanation below.

<P>
All the operators described below are binary operators.  They all pop
two values from the top of the <TT>VMS</TT>, compute the result by applying
the corresponding operator, store the value in a temporary stack
object, set its ID to the union of the IDs of the operands and push it
on the <TT>VMS</TT>.  These operations are performed by the following pseudo
function:
<PRE>
   ComputeResult(L,R,Expr)
     {
         L = pop();     R = pop();
         S = Expr(L,R);
         S.IDList = union(L.IDList,R.IDList);
         push(S);
     }
</PRE>
<TT>Expr</TT> implements the arithmetic of the mathematical operation on
<TT>L</TT> and <TT>R</TT>. 

<P>
Partial derivatives with respect to all the IDs in the ID lists of the
operands are at the top of the corresponding <TT>DS</TT>s.  For all the IDs
common between the two operands, two values are poped from the
corresponding <TT>DS</TT>, say <TT>dxR</TT> and <TT>dxL</TT>.  The common IDs
represent the variables which are part of both the operands (here
<IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$x$">
).  Operations to compute the partial derivatives with respect to
these common variables (equivalent of the <!-- MATH
 ${\partial \over \partial
x}$
 -->
<IMG
 WIDTH="21" HEIGHT="43" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.png"
 ALT="${\partial \over \partial
x}$">
 operator) are represented by the pseudo function <TT>dCommonVar</TT>
below.  The function <TT>CommonExpr</TT> implements the arithmetic for
the derivative computation and is set to the appropriate function for
the various operators.  These values are computed for each ID in the
set composed of the intersection of the ID lists of the two operands,
and pushed on the corresponding <TT>DS</TT> (here, the ID of <IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$x$">
).  Finally,
all IDs common between the two operands are removed from the ID lists
of each operand.
<PRE>
   dCommonVar(L,R,CommonExpr) 
     { 
         IDList = intersection(L.ID,R.ID); 
         for ID in IDList 
           { 
              dxR = pop(DS[ID]); 
              dxL = pop(DS[ID]); 
              push(CommonExpr(L,R,dxL,dxR),DS[ID]);
              L.Remove(ID);  R.Remove(ID); 
           } 
     }
</PRE>
The list of IDs of the two operands now has IDs corresponding to the
non-common variables only (<IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img41.png"
 ALT="$a$">
 and <IMG
 WIDTH="14" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img42.png"
 ALT="$b$">
 here).  Operations for the
partial derivatives of the operands with respect to these variables is
represented by the pseudo function <TT>dNonCommonVar</TT> below.  <TT>LExpr</TT> and <TT>RExpr</TT> computes the value of these derivatives for the
LHS and RHS of the operator (equivalent of computing <!-- MATH
 $\frac{\partial
f(x,a)}{\partial a}$
 -->
<IMG
 WIDTH="47" HEIGHT="46" ALIGN="MIDDLE" BORDER="0"
 SRC="img44.png"
 ALT="$\frac{\partial
f(x,a)}{\partial a}$">
 and <!-- MATH
 $\frac{\partial g(x,b)}{\partial b}$
 -->
<IMG
 WIDTH="46" HEIGHT="46" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.png"
 ALT="$\frac{\partial g(x,b)}{\partial b}$">
) using
the values from the top of the appropriate
<TT>DS</TT>.
<PRE>
   dNonCommonVar(L,R,LExpr, RExpr)
     {
         for ID in L.IDList
            Top(DS[ID]) = LExpr(L,R,Top(DS[ID]));

         for ID in R.IDList
            Top(DS[ID]) = RExpr(L,R,Top(DS[ID]));
     }
</PRE>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html84"
  HREF="node5.html">The multiplication operator</A>
<LI><A NAME="tex2html85"
  HREF="node6.html">The division operator</A>
<LI><A NAME="tex2html86"
  HREF="node7.html">The addition operator</A>
<LI><A NAME="tex2html87"
  HREF="node8.html">The subtraction operator</A>
<LI><A NAME="tex2html88"
  HREF="node9.html">The power operator</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html82"
  HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html80"
  HREF="fussy.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html74"
  HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html83"
  HREF="node5.html">The multiplication operator</A>
<B> Up:</B> <A NAME="tex2html81"
  HREF="fussy.html">The fussy language: Implementation</A>
<B> Previous:</B> <A NAME="tex2html75"
  HREF="node3.html">Example</A>
<!--End of Navigation Panel-->
<ADDRESS>
Sanjay Bhatnagar
2015-10-01
</ADDRESS>
</BODY>
</HTML>
